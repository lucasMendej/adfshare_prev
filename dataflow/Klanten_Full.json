{
	"name": "Klanten_Full",
	"properties": {
		"folder": {
			"name": "CRM"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "SQL_DMS_autoline_customerrecords",
						"type": "DatasetReference"
					},
					"name": "autolineCustomerrecords"
				},
				{
					"dataset": {
						"referenceName": "SQL_DMS_autoline_mktargetcsfields",
						"type": "DatasetReference"
					},
					"name": "autolineMKtargetcsfields"
				},
				{
					"dataset": {
						"referenceName": "SQL_DMS_idas_custm",
						"type": "DatasetReference"
					},
					"name": "idasCustm"
				},
				{
					"dataset": {
						"referenceName": "SQL_DMS_idas_dci",
						"type": "DatasetReference"
					},
					"name": "idasDci"
				},
				{
					"dataset": {
						"referenceName": "SQL_DMS_idas_contrk_h",
						"type": "DatasetReference"
					},
					"name": "idasContrkh"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "CRM_SQL_Klanten",
						"type": "DatasetReference"
					},
					"name": "sinkCustomer"
				}
			],
			"transformations": [
				{
					"name": "autolineSelect"
				},
				{
					"name": "FilterCustomer"
				},
				{
					"name": "joinMKtargetcsfields"
				},
				{
					"name": "autolineAddColumns"
				},
				{
					"name": "autolineCustomerrecordsAddColumnDms"
				},
				{
					"name": "idasFilterCustm"
				},
				{
					"name": "idasJoinDci"
				},
				{
					"name": "idasJoinContrkh"
				},
				{
					"name": "idasAddColumns"
				},
				{
					"name": "idasSelect"
				},
				{
					"name": "Union1"
				}
			],
			"script": "source(output(\n\t\t{_SET} as string,\n\t\t{_COMPANY} as string,\n\t\t{_LTSTUPDATE} as timestamp,\n\t\t{_LTSTCHECK} as timestamp,\n\t\tMAGIC as decimal(10,0),\n\t\tCOMMAGIC as decimal(10,0),\n\t\tSTATUS as string,\n\t\tCREATED as date,\n\t\tEDITED as date,\n\t\tTITLE as string,\n\t\tINITIALS as string,\n\t\tFIRSTNAM as string,\n\t\tSURNAME as string,\n\t\tSALUTE as string,\n\t\tSHORT as string,\n\t\tEXEC_ as string,\n\t\tEXEC001 as string,\n\t\tEXEC002 as string,\n\t\tEXEC003 as string,\n\t\tEXEC004 as string,\n\t\tEXEC005 as string,\n\t\tEXEC006 as string,\n\t\tEXEC007 as string,\n\t\tEXEC008 as string,\n\t\tEXEC009 as string,\n\t\tEXEC010 as string,\n\t\tPHONE as string,\n\t\tPHONE001 as string,\n\t\tPHONE002 as string,\n\t\tPHONE003 as string,\n\t\tPHONE004 as string,\n\t\tADDRESS as string,\n\t\tADDRESS001 as string,\n\t\tADDRESS002 as string,\n\t\tADDRESS003 as string,\n\t\tADDRESS004 as string,\n\t\tADDRESS005 as string,\n\t\tPOSTCODE as string,\n\t\tTARGTYPE as string,\n\t\tTARGTYPE001 as string,\n\t\tTARGTYPE002 as string,\n\t\tTARGTYPE003 as string,\n\t\tTARGTYPE004 as string,\n\t\tTARGTYPE005 as string,\n\t\tTARGTYPE006 as string,\n\t\tTARGTYPE007 as string,\n\t\tTARGTYPE008 as string,\n\t\tTARGTYPE009 as string,\n\t\tTARGTYPE010 as string,\n\t\tLETTERS as string,\n\t\tLETTERS001 as string,\n\t\tLETTERS002 as string,\n\t\tLETTERS003 as string,\n\t\tLETTERS004 as string,\n\t\tLETTERS005 as string,\n\t\tLETTERS006 as string,\n\t\tLETTERS007 as string,\n\t\tLETTERS008 as string,\n\t\tLETTERS009 as string,\n\t\tLETTERS010 as string,\n\t\tCOSTCENT as string,\n\t\tCOSTCENT001 as string,\n\t\tCOSTCENT002 as string,\n\t\tCOSTCENT003 as string,\n\t\tCOSTCENT004 as string,\n\t\tCOSTCENT005 as string,\n\t\tCOSTCENT006 as string,\n\t\tCOSTCENT007 as string,\n\t\tCOSTCENT008 as string,\n\t\tCOSTCENT009 as string,\n\t\tCOSTCENT010 as string,\n\t\tACCOUNT as string,\n\t\tCOMPPOS as string,\n\t\tSUFFIX as string,\n\t\tJOBTITLE as string,\n\t\tSOURCE as string,\n\t\tBY071900 as string,\n\t\tBRANCH as string,\n\t\tBRANCH001 as string,\n\t\tBRANCH002 as string,\n\t\tBRANCH003 as string,\n\t\tUSERID as string,\n\t\tTITLENAM as string,\n\t\tEDUSERID as string,\n\t\tLANGUAGE_ as string,\n\t\tEMAIL as string,\n\t\tOBRANCH as string,\n\t\tOBRANCH001 as string,\n\t\tOBRANCH002 as string,\n\t\tOBRANCH003 as string,\n\t\tDLRCODE as string,\n\t\tDLRCODE001 as string,\n\t\tDLRCODE002 as string,\n\t\tDLRCODE003 as string,\n\t\tTXSTATUS as string,\n\t\tNOMAIL as boolean,\n\t\tCOUNTRYC as string,\n\t\tCHGTIME as decimal(10,0),\n\t\tLOTIME as decimal(10,0),\n\t\tINTNR as decimal(14,0),\n\t\tSOCIALID as string,\n\t\tMOTAB as string,\n\t\tCONAME as string,\n\t\tEXTENSN as string,\n\t\tCARGROUP as string,\n\t\tMANUFACT as string,\n\t\tSEX as string,\n\t\tDOB as date,\n\t\tOSURNAME as string,\n\t\tTPSON as string,\n\t\tTPSON001 as string,\n\t\tTPSON002 as string,\n\t\tTPSON003 as string,\n\t\tTPSON004 as string,\n\t\tTPSON005 as string,\n\t\tKARDEX as string,\n\t\tADDRESS2 as string,\n\t\tADDRESS2001 as string,\n\t\tADDRESS2002 as string,\n\t\tADDRESS2003 as string,\n\t\tADDRESS2004 as string,\n\t\tADDRESS2005 as string,\n\t\tPOSTCOD2 as string,\n\t\tTITLECOD as string,\n\t\tONAME as string,\n\t\tONAME001 as string,\n\t\tONAME002 as string,\n\t\tONAME003 as string,\n\t\tONAME004 as string,\n\t\tWORKAREA as string,\n\t\tWORKCODE as string,\n\t\tWORKNAME as string,\n\t\tWORKADDR as string,\n\t\tWORKADDR001 as string,\n\t\tWORKADDR002 as string,\n\t\tWORKADDR003 as string,\n\t\tWORKADDR004 as string,\n\t\tPREFPHON as string,\n\t\tCMA as boolean,\n\t\tLOYALCOD as string,\n\t\tLOYALNUM as string,\n\t\tLOYALEXP as date,\n\t\tBESTDAY001 as decimal(1,0),\n\t\tBESTDAY002 as decimal(1,0),\n\t\tBESTDAY003 as decimal(1,0),\n\t\tBESTDAY004 as decimal(1,0),\n\t\tBESTDAY005 as decimal(1,0),\n\t\tBESTDAY006 as decimal(1,0),\n\t\tBESTDAY007 as decimal(1,0),\n\t\tBESTBEG001 as decimal(5,0),\n\t\tBESTBEG002 as decimal(5,0),\n\t\tBESTBEG003 as decimal(5,0),\n\t\tBESTBEG004 as decimal(5,0),\n\t\tBESTBEG005 as decimal(5,0),\n\t\tBESTBEG006 as decimal(5,0),\n\t\tBESTBEG007 as decimal(5,0),\n\t\tBESTEND001 as decimal(5,0),\n\t\tBESTEND002 as decimal(5,0),\n\t\tBESTEND003 as decimal(5,0),\n\t\tBESTEND004 as decimal(5,0),\n\t\tBESTEND005 as decimal(5,0),\n\t\tBESTEND006 as decimal(5,0),\n\t\tBESTEND007 as decimal(5,0),\n\t\tSENSITIV as string,\n\t\tTRANTYPE as decimal(10,0),\n\t\tVATREG as string,\n\t\tMSTART as date,\n\t\tMAUTH as string,\n\t\tBY185500 as string,\n\t\tBUSTYPE as string,\n\t\tSUPPLIER as string,\n\t\tBY187400 as string,\n\t\tBACS as boolean,\n\t\tBANKREGC as string,\n\t\tORGSCODE as string,\n\t\tBXBANKAC as string,\n\t\tVATREG2 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\trowUrlColumn: 'filename',\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\twildcardPaths:['sternData/dataFactoryLandingZone/autoline*/mk_00_customerrecords.parquet']) ~> autolineCustomerrecords\nsource(output(\n\t\t{_SET} as string,\n\t\t{_COMPANY} as string,\n\t\t{_LTSTUPDATE} as timestamp,\n\t\t{_LTSTCHECK} as timestamp,\n\t\tMAGIC as decimal(10,0),\n\t\tRDCMAGIC as string,\n\t\tAIRMILES as string,\n\t\tHOBBY as string,\n\t\tHOBBY001 as string,\n\t\tHOBBY002 as string,\n\t\tHOBBY003 as string,\n\t\tHOBBY004 as string,\n\t\tHOBBY005 as string,\n\t\tSPORT as string,\n\t\tSPORT001 as string,\n\t\tSPORT002 as string,\n\t\tSPORT003 as string,\n\t\tSPORT004 as string,\n\t\tSPORT005 as string,\n\t\tDEAMAG as string,\n\t\tDEAMAG001 as string,\n\t\tDEAMAG002 as string,\n\t\tDEAMAG003 as string,\n\t\tDEAMAG004 as string,\n\t\tDEAMAG005 as string,\n\t\tCONTACT as string,\n\t\tCONTACT001 as string,\n\t\tCONTACT002 as string,\n\t\tCONTACT003 as string,\n\t\tCONTACT004 as string,\n\t\tCONTACT005 as string,\n\t\tCREDCRD as string,\n\t\tCREDCRD001 as string,\n\t\tCREDCRD002 as string,\n\t\tCREDCRD003 as string,\n\t\tFAMILY as string,\n\t\tPURCRIT as string,\n\t\tPURCRIT001 as string,\n\t\tPURCRIT002 as string,\n\t\tSTATUS as string,\n\t\tCURTYPE as string,\n\t\tCURMAKE as string,\n\t\tCURMODEL as string,\n\t\tCURBODY as string,\n\t\tCURYEAR as string,\n\t\tCURENGIN as string,\n\t\tINTGRP as string,\n\t\tINTGRP001 as string,\n\t\tINTGRP002 as string,\n\t\tINTEREST as string,\n\t\tINTMAKE as string,\n\t\tINTMODEL as string,\n\t\tINTBODY as string,\n\t\tINTPRICE as decimal(14,2),\n\t\tINTAXLE as decimal(10,0),\n\t\tINTENGIN as string,\n\t\tINTGVW as string,\n\t\tVATOBLIG as boolean,\n\t\tVATREG as string,\n\t\tCNTRYCOD as string,\n\t\tCPSKIP as boolean,\n\t\tINVCLAUS as string,\n\t\tBOATADDR as boolean,\n\t\tBEMAIL as string,\n\t\tGENERAT as string,\n\t\tTITLEAFT as string,\n\t\tISDECEAS as boolean,\n\t\tTITLE as string,\n\t\tGENDER as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\trowUrlColumn: 'filename',\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\twildcardPaths:['sternData/dataFactoryLandingZone/autoline*/cs_nl_mktargetcsfields.parquet']) ~> autolineMKtargetcsfields\nsource(output(\n\t\t{_SET} as string,\n\t\t{_COMPANY} as string,\n\t\t{_LTSTUPDATE} as timestamp,\n\t\t{_LTSTCHECK} as timestamp,\n\t\tCBRCO as decimal(2,0),\n\t\tCCUSNO as decimal(6,0),\n\t\tCPBX as string,\n\t\tCAANH as string,\n\t\tCTITL as string,\n\t\tCVLET as string,\n\t\tCVOEG as string,\n\t\tCNAAM1 as string,\n\t\tCNAAM2 as string,\n\t\tCADRES as string,\n\t\tCHUISN as decimal(5,0),\n\t\tCHUIST as string,\n\t\tCPOCO as string,\n\t\tCCITY as string,\n\t\tCLANDK as string,\n\t\tCTAALK as decimal(2,0),\n\t\tCFICAT as string,\n\t\tCAROB as string,\n\t\tCGESL as string,\n\t\tCFILL5 as string,\n\t\tCDCAT as decimal(2,0),\n\t\tCOWDI as string,\n\t\tCCACR as decimal(1,0),\n\t\tCINVC as decimal(1,0),\n\t\tCVAT as decimal(1,0),\n\t\tCPROF as string,\n\t\tCTIT as string,\n\t\tCCAT as decimal(2,0),\n\t\tCSTAT as decimal(1,0),\n\t\tCFILL4 as decimal(14,0),\n\t\tCFAKT as decimal(1,0),\n\t\tCSALEM as string,\n\t\tCBGKD as string,\n\t\tCBGNR as decimal(9,0),\n\t\tCCSP as string,\n\t\tCCSPA as decimal(8,0),\n\t\tCDMAIL as string,\n\t\tCFIL as decimal(2,0),\n\t\tCNAWN1 as decimal(6,0),\n\t\tCNAWN2 as decimal(6,0),\n\t\tCCWNEW as decimal(4,0),\n\t\tCCWNER as string,\n\t\tCCSINT as decimal(3,0),\n\t\tCCSLAW as decimal(4,0),\n\t\tCCSNEW as decimal(4,0),\n\t\tCCSNER as string,\n\t\tCSEGKD as string,\n\t\tCCDGE as string,\n\t\tCWSNO as string,\n\t\tCTELO as string,\n\t\tCTELR as string,\n\t\tCFAXNR as string,\n\t\tCBTWNR as string,\n\t\tCLIM as decimal(5,0),\n\t\tCCOINV as string,\n\t\tCBRUPR as string,\n\t\tCRELT as string,\n\t\tCSDX as string,\n\t\tCPST as decimal(4,0)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> idasCustm\nsource(output(\n\t\t{_SET} as string,\n\t\t{_COMPANY} as string,\n\t\t{_LTSTUPDATE} as timestamp,\n\t\t{_LTSTCHECK} as timestamp,\n\t\tCICCAT as decimal(2,0),\n\t\tCICUST as decimal(6,0),\n\t\tCIVNAM as string,\n\t\tCIGDAT as string,\n\t\tCIADRS as string,\n\t\tCIHSNR as decimal(5,0),\n\t\tCIHTOE as string,\n\t\tCIPOCO as string,\n\t\tCICITY as string,\n\t\tCIPTEL as string,\n\t\tCIINNM as string,\n\t\tCIINPN as string,\n\t\tCIALTV as decimal(1,0),\n\t\tCIMWRK as string,\n\t\tCIVACC as string,\n\t\tCIAMZO as string,\n\t\tCIAMZV as string,\n\t\tCITEXT as string,\n\t\tCITXT2 as string,\n\t\tCIMAIL as string,\n\t\tCIRDCN as decimal(6,0),\n\t\tCISUBL as string,\n\t\tCIVEH as decimal(7,0),\n\t\tCIVEM1 as decimal(7,0),\n\t\tCIVEM2 as decimal(7,0),\n\t\tCIVEM3 as decimal(7,0),\n\t\tCIVETO as decimal(9,0),\n\t\tCIOHH as decimal(7,0),\n\t\tCIOHM1 as decimal(7,0),\n\t\tCIOHM2 as decimal(7,0),\n\t\tCIOHM3 as decimal(7,0),\n\t\tCIOHTO as decimal(9,0),\n\t\tCIODH as decimal(7,0),\n\t\tCIODM1 as decimal(7,0),\n\t\tCIODM2 as decimal(7,0),\n\t\tCIODM3 as decimal(7,0),\n\t\tCIODTO as decimal(9,0),\n\t\tCIJRKL as decimal(2,0),\n\t\tCIOSLD as decimal(10,2),\n\t\tCIKRLM as decimal(8,2),\n\t\tCITOND as decimal(4,0),\n\t\tCITANW as decimal(4,0),\n\t\tCITAGB as decimal(4,0),\n\t\tCIAOND as decimal(4,0),\n\t\tCIAANW as decimal(4,0),\n\t\tCIAAGB as decimal(4,0),\n\t\tCIVEHB as decimal(7,0),\n\t\tCIVEM1B as decimal(7,0),\n\t\tCIVEM2B as decimal(7,0),\n\t\tCIVEM3B as decimal(7,0),\n\t\tCIVETOB as decimal(9,0),\n\t\tCIOHHB as decimal(7,0),\n\t\tCIOHM1B as decimal(7,0),\n\t\tCIOHM2B as decimal(7,0),\n\t\tCIOHM3B as decimal(7,0),\n\t\tCIOHTOB as decimal(9,0),\n\t\tCIODHB as decimal(7,0),\n\t\tCIODM1B as decimal(7,0),\n\t\tCIODM2B as decimal(7,0),\n\t\tCIODM3B as decimal(7,0),\n\t\tCIODTOB as decimal(9,0),\n\t\tCIJRKLB as decimal(2,0),\n\t\tCIOSLDB as decimal(10,2),\n\t\tCIKRLMB as decimal(8,2),\n\t\tCITONDB as decimal(4,0),\n\t\tCITANWB as decimal(4,0),\n\t\tCITAGBB as decimal(4,0),\n\t\tCIAONDB as decimal(4,0),\n\t\tCIAANWB as decimal(4,0),\n\t\tCIAAGBB as decimal(4,0),\n\t\tCIVEHD as decimal(7,0),\n\t\tCIVEM1D as decimal(7,0),\n\t\tCIVEM2D as decimal(7,0),\n\t\tCIVEM3D as decimal(7,0),\n\t\tCIVETOD as decimal(9,0),\n\t\tCIOHHD as decimal(7,0),\n\t\tCIOHM1D as decimal(7,0),\n\t\tCIOHM2D as decimal(7,0),\n\t\tCIOHM3D as decimal(7,0),\n\t\tCIOHTOD as decimal(9,0),\n\t\tCIODHD as decimal(7,0),\n\t\tCIODM1D as decimal(7,0),\n\t\tCIODM2D as decimal(7,0),\n\t\tCIODM3D as decimal(7,0),\n\t\tCIODTOD as decimal(9,0),\n\t\tCIJRKLD as decimal(2,0),\n\t\tCIOSLDD as decimal(10,2),\n\t\tCIKRLMD as decimal(8,2),\n\t\tCITONDD as decimal(4,0),\n\t\tCITANWD as decimal(4,0),\n\t\tCITAGBD as decimal(4,0),\n\t\tCIAONDD as decimal(4,0),\n\t\tCIAANWD as decimal(4,0),\n\t\tCIAAGBD as decimal(4,0),\n\t\tCIDCRR as string,\n\t\tCIDKLT as string,\n\t\tCIMUTD as string,\n\t\tCIMUTT as string,\n\t\tCIMUTU as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> idasDci\nsource(output(\n\t\t{_SET} as string,\n\t\t{_COMPANY} as string,\n\t\t{_LTSTUPDATE} as timestamp,\n\t\t{_LTSTCHECK} as timestamp,\n\t\tRKRCCD as string,\n\t\tRKKCTK as string,\n\t\tRKLNTX as string,\n\t\t{F137#1} as string,\n\t\tRKWSID as string,\n\t\t{F030#1} as string,\n\t\tRKKCTL2 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> idasContrkh\njoinMKtargetcsfields select(mapColumn(\n\t\tklantnr = autolineCustomerrecords@MAGIC,\n\t\tklantnaam = TITLENAM,\n\t\tadres = ADDRESS001,\n\t\twoonplaats = ADDRESS004,\n\t\tpostcode = POSTCODE,\n\t\tland = ADDRESS005,\n\t\tpostbus = ADDRESS002,\n\t\tpostcode_plaats_postbus = ADDRESS004,\n\t\temail = EMAIL,\n\t\tman_vrouw = SEX,\n\t\tgeboortedatum = DOB,\n\t\tstatus = autolineCustomerrecords@STATUS,\n\t\tbedrijfsnr = COMMAGIC,\n\t\ttelefoon = PHONE001,\n\t\ttelefoonwerk = PHONE002,\n\t\tmobiel = PHONE004,\n\t\tfax = PHONE003,\n\t\tsoort = BUSTYPE,\n\t\tzakelijkemail = BEMAIL,\n\t\toverleden = ISDECEAS,\n\t\tdms = autolineCustomerrecords@{_SET},\n\t\tedited = EDITED\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> autolineSelect\nautolineAddColumns filter(isNull(klantnr) == false()) ~> FilterCustomer\nautolineCustomerrecordsAddColumnDms, autolineMKtargetcsfields join(autolineCustomerrecords@MAGIC == autolineMKtargetcsfields@MAGIC\n\t&& autolineCustomerrecords@{_SET} == autolineMKtargetcsfields@{_SET},\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> joinMKtargetcsfields\nautolineSelect derive(geboortedatum = case( greater(geboortedatum, toDate('1900-01-01 00:00:00')) == true(),geboortedatum,toDate('')),\n\t\tbedrijf = '0',\n\t\tland = left(land, 32),\n\t\ttelefoon = iif(equals(length(regexReplace(trim(telefoon),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(telefoon),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(telefoon),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(telefoon),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(telefoon),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(telefoon),'(-| |\\\\(|\\\\))',''), '')),\n\t\ttelefoonwerk = iif(equals(length(regexReplace(trim(telefoonwerk),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(telefoonwerk),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(telefoonwerk),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(telefoonwerk),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(telefoonwerk),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(telefoonwerk),'(-| |\\\\(|\\\\))',''), '')),\n\t\tmobiel = iif(equals(length(regexReplace(trim(mobiel),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(mobiel),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(mobiel),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(mobiel),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(mobiel),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(mobiel),'(-| |\\\\(|\\\\))',''), '')),\n\t\tfax = iif(equals(length(regexReplace(trim(fax),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(fax),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(fax),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(fax),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(fax),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(fax),'(-| |\\\\(|\\\\))',''), ''))) ~> autolineAddColumns\nautolineCustomerrecords derive(EDITED = case(isNull(EDITED),case(isNull(CREATED),addDays(currentDate(), -365) , CREATED) , EDITED)) ~> autolineCustomerrecordsAddColumnDms\nidasCustm filter(CRELT != 'PSS' && CRELT != 'PRO' && CRELT != 'PRE' && CRELT != 'OVL' && CRELT != 'IAK' && CPBX == 'P') ~> idasFilterCustm\nidasFilterCustm, idasDci join(CCUSNO == CICUST,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> idasJoinDci\nidasJoinDci, idasContrkh join(CLANDK == right(RKKCTK, 2),\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> idasJoinContrkh\nidasJoinContrkh derive(bedrijf = toString(toInteger(CFIL)),\n\t\tklantnaam = ltrim(replace(concat(rtrim(CVLET), ' ',rtrim(CVOEG),' ',rtrim(CNAAM1)),'  ','')),\n\t\tadres = rtrim(concat(rtrim(CADRES),' ',toString(toInteger(CHUISN)),' ',toString(CHUIST))),\n\t\twoonplaats = rtrim(CCITY),\n\t\tpostcode = concat(left(CPOCO,4),' ',right(CPOCO,2)),\n\t\tland = case(or(isNull(RKLNTX),CLANDK == 'NL'), '', RKLNTX),\n\t\tpostbus = '',\n\t\tpostcode_plaats_postbus = '',\n\t\temail = case(rtrim(CIMAIL) == 'geen@mail.nl', '', rtrim(CIMAIL)),\n\t\tgeboortedatum = toDate(''),\n\t\tbedrijfsnr = 0,\n\t\ttelefoon = iif(equals(length(regexReplace(trim(CTELR),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(CTELR),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(CTELR),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(CTELR),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(CTELR),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(CTELR),'(-| |\\\\(|\\\\))',''), '')),\n\t\ttelefoonwerk = iif(equals(length(regexReplace(trim(CTELO),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(CTELO),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(CTELO),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(CTELO),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(CTELO),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(CTELO),'(-| |\\\\(|\\\\))',''), '')),\n\t\tmobiel = iif(equals(length(regexReplace(trim(CIPTEL),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(CIPTEL),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(CIPTEL),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(CIPTEL),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(CIPTEL),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(CIPTEL),'(-| |\\\\(|\\\\))',''), '')),\n\t\tfax = iif(equals(length(regexReplace(trim(CFAXNR),'(-| |\\\\(|\\\\))','')),10),iif(equals(left(regexReplace(trim(CFAXNR),'(-| |\\\\(|\\\\))',''),1), '0'), concat('+31',right(regexReplace(trim(CFAXNR),'(-| |\\\\(|\\\\))',''), 9)), ''),iif( and(equals(length(regexReplace(trim(CFAXNR),'(-| |\\\\(|\\\\))','')),12),equals(left(regexReplace(trim(CFAXNR),'(-| |\\\\(|\\\\))',''), 1), '+')), regexReplace(trim(CFAXNR),'(-| |\\\\(|\\\\))',''), '')),\n\t\tzakelijkemail = '',\n\t\toverleden = toBoolean(''),\n\t\tsoort = '',\n\t\tklantnr = toInteger(CCUSNO),\n\t\tedited = currentDate()) ~> idasAddColumns\nidasAddColumns select(mapColumn(\n\t\tklantnr,\n\t\tbedrijf,\n\t\tklantnaam,\n\t\tadres,\n\t\twoonplaats,\n\t\tpostcode,\n\t\tland,\n\t\tpostbus,\n\t\tpostcode_plaats_postbus,\n\t\temail,\n\t\tman_vrouw = CGESL,\n\t\tgeboortedatum,\n\t\tstatus = CRELT,\n\t\tbedrijfsnr,\n\t\ttelefoon,\n\t\ttelefoonwerk,\n\t\tmobiel,\n\t\tfax,\n\t\tsoort,\n\t\tdms = idasCustm@{_SET},\n\t\tzakelijkemail,\n\t\toverleden,\n\t\tedited\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> idasSelect\nFilterCustomer, idasSelect union(byName: true)~> Union1\nUnion1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tdms as string,\n\t\tbedrijf as string,\n\t\tklantnr as decimal(20,0),\n\t\tklantnaam as string,\n\t\tadres as string,\n\t\twoonplaats as string,\n\t\tpostcode as string,\n\t\tland as string,\n\t\tpostbus as string,\n\t\tpostcode_plaats_postbus as string,\n\t\temail as string,\n\t\tman_vrouw as string,\n\t\tgeboortedatum as timestamp,\n\t\tstatus as string,\n\t\tbedrijfsnr as decimal(10,0),\n\t\ttelefoon as string,\n\t\ttelefoonwerk as string,\n\t\tmobiel as string,\n\t\tfax as string,\n\t\tsoort as string,\n\t\tzakelijkemail as string,\n\t\toverleden as boolean,\n\t\tedited as timestamp\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tdms,\n\t\tbedrijf,\n\t\tklantnr,\n\t\tklantnaam,\n\t\tadres,\n\t\twoonplaats,\n\t\tpostcode,\n\t\tland,\n\t\tpostbus,\n\t\tpostcode_plaats_postbus,\n\t\temail,\n\t\tman_vrouw,\n\t\tgeboortedatum,\n\t\tstatus,\n\t\tbedrijfsnr,\n\t\ttelefoon,\n\t\ttelefoonwerk,\n\t\tmobiel,\n\t\tfax,\n\t\tsoort,\n\t\tzakelijkemail,\n\t\toverleden,\n\t\tedited\n\t)) ~> sinkCustomer"
		}
	}
}